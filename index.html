<html>
  <head>
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
	<script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.6.0/aframe/build/aframe-ar.js"></script>
	<script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <!-- <script src="https://rawgit.com/nicolocarpignoli/nicolocarpignoli.github.io/master/ar-click-events/events.js"></script> -->
  </head>
  <body style='margin : 0px; overflow: hidden;'>
	<!-- <a-scene embedded arjs='sourceType: webcam;' stats artoolkit> -->
	<a-scene embedded arjs='debugUIEnabled: false;' stats startButton>
		<a-assets>
			<a-asset-item id="wraith" src="models/wraith.glb"></a-asset-item>
		</a-assets>
		<!-- <a-box id="boxId" position="-0.6 0 -3" rotation="0 0 0" scale="0.2 0.2 0.2" color="blue"></a-box> -->
		<a-marker preset='hiro' markerhandler emitevents="true" cursor="rayOrigin: mouse" id="animated-marker" type='barcode' value='6'>
			<!-- <a-text value="Wraith!"></a-text> -->
			<a-entity
			id="animated-model"
			gltf-model="#wraith"
			scale="0.03 0.03 0.03" 
			position="0 0 0"
			></a-entity>
		</a-marker>
		<a-entity camera></a-entity>
	</a-scene>
	<!-- <script type="text/javascript">
		AFRAME.registerComponent('startButton', {
		  init: function () {
			var cube = document.querySelector('a-scene').sceneEl.querySelector("#boxId");
			cube.addEventListener("mousedown", function (evt) {
			  cube.setAttribute('material', 'color', 'red');
			});
			cube.addEventListener("mouseup", function (evt) {
			  cube.setAttribute('material', 'color', 'green');//we want to change this from "blue" to "green" to avoid some bugs
			});
			cube.addEventListener("mouseenter", function (evt) {
			  cube.setAttribute('material', 'color', 'green');
			});
			cube.addEventListener("mouseleave", function (evt) {
			  cube.setAttribute('material', 'color', 'blue');
			});
		  }
		});
	</script> -->

	<script type="text/javascript">		
		AFRAME.registerComponent('markerhandler', {

		init: function() {
			const animatedMarker = document.querySelector("#animated-marker");
			const aEntity = document.querySelector("#animated-model");

			// every click, we make our model grow in size :)
			animatedMarker.addEventListener('click', function(ev, target){
				const intersectedElement = ev && ev.detail && ev.detail.intersectedEl;
				if (aEntity && intersectedElement === aEntity) {
					const scale = aEntity.getAttribute('scale');
					Object.keys(scale).forEach((key) => scale[key] = scale[key] + 0.01);
					aEntity.setAttribute('scale', scale);
				}
			});
		}});
	</script>
  </body>
</html>